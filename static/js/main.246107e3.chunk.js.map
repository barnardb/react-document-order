{"version":3,"sources":["../../src/Context.ts","../../src/operations.ts","../../src/OrderedValues.tsx","ReadmeExample.tsx","ToDoList.tsx","TrivialExample.tsx","App.tsx","index.tsx"],"names":["contextSignifier","Symbol","isContext","node","firstValue","context","startIndex","result","lastValue","length","nonNull","Error","registerChangeOnRoot","createOrderedValues","reactContext","React","changeIndicatorReactContext","useContext","Provider","children","useReducer","changeIndicator","registerChange","parent","useMemo","createContext","useLayoutEffect","i","value","useRegister","t","useValueAfter","firstValueAfterReference","reference","useRoot","useValueBefore","firstValueBeforeReference","useFirst","useLast","root","MyCollection","ReadmeExample","MyFormContent","useState","email","setEmail","style","display","flexDirection","MyInput","label","onChange","endsWith","ref","useRef","placeholder","maxWidth","margin","e","target","useUpDownBehaviour","previous","next","onKeyDownCapture","nativeEvent","key","preventDefault","current","focus","ControlOrder","first","last","metaKey","Item","onRemove","onClick","marginLeft","borderLeft","paddingLeft","addLabel","AddButton","List","ids","nextId","setState","map","id","slice","ToDoList","LabelOrder","Label","name","role","aria-label","nullIndicator","TrivialExample","labels","middleLables","addMiddleLabel","l","backgroundColor","padding","borderRadius","lineHeight","App","app","h1","p","a","href","main","section","alignItems","marginInline","textAlign","fontWeight","width","flexWrap","justifyContent","color","flex","border","ReactDOM","render","document","getElementById"],"mappings":"oQAAMA,EAAmBC,OAAzB,mC,SAwBgBC,EAAaC,GAC3B,MAAuB,kBAATA,GAAqBH,KAAnC,E,SCvBcI,EACdC,EACAC,GAEA,KAAOA,EAAaD,QAApB,QAA0C,CACxC,IAAMF,EAAOE,QAAb,GACME,EAASL,KAAkBE,EAAWD,EAA7BD,GAAf,EACA,GAAIK,eAAJ,IAAuBA,EAAsB,OAAOA,IACpD,EAEF,YAGF,SAAgBC,EAAaH,EAAqBI,GAChD,OAASA,GAAT,GAAsB,CACpB,IAAMN,EAAOE,QAAb,GACME,EAASL,KAAkBM,EAAUL,EAAMA,QAAlCD,QAAf,EACA,GAAIK,eAAJ,IAAuBA,EAAsB,OAAOA,EAEtD,YCFF,SAASG,EAAT,GACE,MACE,MAAM,IAAIC,MAAV,sFAGF,SAGF,SAASC,EAAqBP,GAC5BA,SACIO,EAAqBP,EADzBA,QAEIA,sBAFJA,GAKF,SAAgBQ,IAGd,IAAMC,EAAeC,kBAArB,MACMC,EAA8BD,kBAApC,MAEA,aAEE,IADA,IAAIV,EAAUK,EAAQO,qBAAtB,IACOZ,EAAP,QAAuBA,EAAUA,EAAVA,OACvB,SAGF,MAAO,CACLa,SAAU,SAA+B,G,IAAEC,a,EACCC,sBACxC,wBADkD,GAA7CC,OAAiBC,OAKlBC,EAASN,qBAAf,GACMZ,EAAUmB,mBACd,kB,SFxCNF,G,MAEA,qEEsCYG,CAAN,KADF,IAuBA,OAjBAD,mBAAQ,WACN,IACAnB,WACAkB,mBACC,CAJHC,IAMAE,2BAAgB,WACd,KAEA,OADAd,KACO,WAEL,IAAMe,EAAIJ,gBAAV,GACAI,MAAUJ,iBAAVI,GACItB,WAAJ,IAA+BA,kBAEhC,CATHqB,IAYE,kBAACZ,EAAD,UAAuBc,MAAOvB,GAC3BkB,EAAS,EAGR,kBAACP,EAAD,UAAsCY,MAAOP,GALnD,KAaFQ,YAAa,SAAqBC,GAChC,IAAMzB,EAAUK,EAAQO,qBAAxB,IACAO,mBAAQ,WAENnB,kBACC,CAACA,EAHJmB,IAIAE,2BAAgB,WAEd,OADAd,KACO,WAEL,IAAK,IAAIe,EAAItB,eAAb,EAAuCsB,GAAvC,MACE,GAAItB,aAAJ,EAGE,OAFAA,yBACAO,QAIL,CAACP,EAXJqB,KAcFK,cAAe,SAAuB,GAIpC,OADAd,wBDxFN,SAAgBe,EACd3B,EACA4B,GAEA,IAAK,IAAIN,EAAT,EAAgBA,EAAItB,QAApB,OAA0CsB,IAAK,CAC7C,IAAMxB,EAAOE,QAAb,GACA,GAAIH,EAAJ,GAAqB,CACnB,IAAMK,EAASyB,EAAyB7B,EAAxC,GACA,YAAII,EAAsB,SAC1B,UAAIA,EAAiB,OAAOA,OACvB,GAAIJ,IAAJ,EACL,SAEF,OAAOC,EAAWC,EAASsB,EAA3B,IC4ESK,CAAyBE,IAAhC,IAGFC,eAAgB,SAAwB,GAItC,OADAlB,wBD7EN,SAAgBmB,EACd/B,EACA4B,GAEA,IAAK,IAAIN,EAAItB,eAAb,EAAuCsB,GAAvC,EAA+CA,IAAK,CAClD,IAAMxB,EAAOE,QAAb,GACA,GAAIH,EAAJ,GAAqB,CACnB,IAAMK,EAAS6B,EAA0BjC,EAAzC,GACA,YAAII,EAAsB,SAC1B,UAAIA,EAAiB,OAAOA,OACvB,GAAIJ,IAAJ,EACL,SAEF,OAAOK,EAAUH,EAAjB,ICiES+B,CAA0BF,IAAjC,IAGFG,SAAU,WAER,OADApB,wBACOb,EAAW8B,IAAlB,IAGFI,QAAS,WACPrB,wBACA,IAAMsB,EAAOL,IACb,OAAO1B,EAAU+B,EAAMA,QAAvB,UCpHN,IAAMC,EAAe3B,IAgBN,SAAS4B,IACtB,OACE,kBAACD,EAAatB,SAAd,KACE,kBAACwB,EAAD,OAQN,SAASA,IAAiB,IAAD,EACGC,mBAAS,IADZ,mBAChBC,EADgB,KACTC,EADS,KAEvB,OACE,yBAAKC,MAAO,CAAEC,QAAS,OAAQC,cAAe,WAC5C,kBAACC,EAAD,CAASC,MAAM,SACf,kBAACD,EAAD,CAASC,MAAM,gBAAgBC,SAAUN,IACzC,kBAACL,EAAatB,SAAd,KACG0B,EAAMQ,SAAS,iBAAmB,kBAACH,EAAD,CAASC,MAAM,+BAEpD,kBAACD,EAAD,CAASC,MAAM,qBAOrB,SAASD,EAAT,GAA8F,IAA3EC,EAA0E,EAA1EA,MAAOC,EAAmE,EAAnEA,SAClBE,EAAMC,iBAAyB,MAErC,OADAd,EAAaX,YAAYwB,GAEvB,yCACEE,YAAaL,EACbJ,MAAO,CAACU,SAAU,OAAQC,OAAQ,SAClCN,SAAUA,GAAa,SAAAO,GAAC,OAAIP,EAASO,EAAEC,OAAO/B,QAC9CyB,IAAKA,GACDO,EAAmBP,KAO7B,IAAMO,EAAqB,SAACP,GAC1B,IAAMQ,EAAWrB,EAAaL,eAAekB,GACvCS,EAAOtB,EAAaT,cAAcsB,GACxC,MAAO,CACLU,iBAAkB,SAACL,GACqB,IAAD,EAArC,GAA0B,YAAtBA,EAAEM,YAAYC,IAChBP,EAAEQ,iBACM,OAARL,QAAQ,IAARA,GAAA,UAAAA,EAAUM,eAAV,SAAmBC,aACd,GAA0B,cAAtBV,EAAEM,YAAYC,IAAqB,CAAC,IAAD,EAC5CP,EAAEQ,iBACE,OAAJJ,QAAI,IAAJA,GAAA,UAAAA,EAAMK,eAAN,SAAeC,Y,OCjFjBC,EAAexD,IAEf+C,EAAqB,SAACP,GAC1B,IAAMiB,EAAQD,EAAahC,WACrBwB,EAAWQ,EAAalC,eAAekB,GACvCS,EAAOO,EAAatC,cAAcsB,GAClCkB,EAAOF,EAAa/B,UAC1B,MAAO,CACLyB,iBAAkB,SAACL,GACqB,IAAD,IAArC,GAA0B,YAAtBA,EAAEM,YAAYC,IAChBP,EAAEQ,iBACF,QAAC,EAAAR,EAAEM,YAAYQ,QAAUF,EAAQT,SAAjC,mBAA4CM,eAA5C,SAAqDC,aAChD,GAA0B,cAAtBV,EAAEM,YAAYC,IAAqB,CAAC,IAAD,IAC5CP,EAAEQ,iBACF,QAAC,EAAAR,EAAEM,YAAYQ,QAAUD,EAAOT,SAAhC,mBAAuCK,eAAvC,SAAgDC,YAMlDK,EAAO,SAAC,GAA4C,IAA1CC,EAAyC,EAAzCA,SACRrB,EAAMC,iBAAyB,MAErC,OADAe,EAAaxC,YAAYwB,GAClB,6BACL,yBAAKP,MAAO,CAAEE,cAAe,QAC3B,yCAAOK,IAAKA,GAASO,EAAmBP,KACxC,4BAAQsB,QAASD,GAAjB,MAEF,yBAAK5B,MAAO,CAAE8B,WAAY,MAAOC,WAAY,sBAAuBC,YAAa,QAC/E,kBAAC,EAAD,CAAMC,SAAS,oBAKfC,EAAY,SAAC,GAAgE,IAA9D9B,EAA6D,EAA7DA,MAAOyB,EAAsD,EAAtDA,QACpBtB,EAAMC,iBAA0B,MAEtC,OADAe,EAAaxC,YAAYwB,GAClB,0CAAQA,IAAKA,EAAKsB,QAASA,GAAaf,EAAmBP,IAAOH,IAGrE+B,EAAO,SAAC,GAAwC,IAAtCF,EAAqC,EAArCA,SAAqC,EACfpC,mBAAS,CAAEuC,IAAK,GAA6BC,OAAQ,IADtC,0BAC1CD,EAD0C,EAC1CA,IAAKC,EADqC,EACrCA,OAAUC,EAD2B,KAEnD,OACE,yBAAKtC,MAAO,CAAEE,cAAe,WAC3B,kBAACqB,EAAanD,SAAd,KACGgE,EAAIG,KAAI,SAACC,EAAI3D,GAAL,OACP,yBAAKsC,IAAKqB,EAAIxC,MAAO,CAAEE,cAAe,QACpC,kBAAC,EAAD,CAAM0B,SAAU,kBAAMU,EAAS,CAAEF,IAAI,GAAD,mBAAMA,EAAIK,MAAM,EAAG5D,IAAnB,YAA0BuD,EAAIK,MAAM5D,EAAI,KAAKwD,mBAIvF,kBAAC,EAAD,CAAWjC,MAAO6B,EAAUJ,QAAS,kBAAMS,EAAS,CAAEF,IAAI,GAAD,mBAAMA,GAAN,CAAWC,IAASA,OAAQA,EAAS,SAKrF,SAASK,IACtB,OACE,kBAACnB,EAAanD,SAAd,KACE,yFAGA,8SAKA,kBAAC,EAAD,CAAM6D,SAAS,wB,YCnEfU,EAAa5E,IAEb6E,EAAQ,SAAC,GAAgC,IAA9BC,EAA6B,EAA7BA,KACfF,EAAW5D,YAAY8D,GACvB,IAAM7B,EAAO2B,EAAW1D,cAAc4D,GACtC,OAAO,yBAAK7C,MAAOI,GAAZ,SACEyC,EADF,gBAEH7B,GAAQ,0BAAM8B,KAAK,MAAMC,aAAW,UAAU/C,MAAOgD,GAA7C,YAKC,SAASC,IAAkB,IAAD,EACA3E,sBAAW,WAAc8B,GAAd,IAAK8C,EAAL,oDAAoCA,GAApC,CAA4C9C,MAAQ,CAAC,QADhE,mBAChC+C,EADgC,KAClBC,EADkB,KAGvC,OACE,kBAACT,EAAWvE,SAAZ,KACE,kBAAC,EAAD,CAAOyE,KAAK,QACZ,kBAACF,EAAWvE,SAAZ,KACG+E,EAAaZ,KAAI,SAAAc,GAAC,OAAI,kBAAC,EAAD,CAAOlC,IAAKkC,EAAGR,KAAMQ,QAE9C,kBAAC,EAAD,CAAOR,KAAK,QACZ,4BAAQhB,QAAS,kBAAMuB,EAAe,OAAD,OAAQD,EAAaxF,WAA1D,QAKN,IAAMyC,EAAQ,CAAEO,OAAQ,QAAS2C,gBAAiB,OAAQC,QAAS,QAASC,aAAc,OACpFR,EAAgB,CAAES,WAAY,GCuBrBC,EAjDH,WACV,OACE,yBAAK1D,MAAO2D,GAEV,wBAAI3D,MAAO4D,GAAI,sDAAf,SAEA,uBAAG5D,MAAO6D,GAAV,oCACmC,uBAC/B7D,MAAO8D,EACPC,KAAK,oDAF0B,wBADnC,wEAQM,uBACF/D,MAAO8D,EACPC,KAAK,yEACN,2CAHG,SARN,4DAcA,0BAAM/D,MAAOgE,GAEX,6BAAShE,MAAOiE,EAAQ,SACtB,8CACA,2BAAG,uBAAGjE,MAAO8D,EAAGC,KAAK,4FAAlB,mBAA6H,wCAChI,iJAEA,kBAACpE,EAAD,OAGF,6BAASK,MAAOiE,EAAQ,SACtB,+CACA,2BAAG,uBAAGjE,MAAO8D,EAAGC,KAAK,6FAAlB,mBAA8H,sDACjI,+FACA,kBAACd,EAAD,OAGF,6BAASjD,MAAOiE,EAAQ,SACtB,uDACA,2BAAG,uBAAGjE,MAAO8D,EAAGC,KAAK,uFAAlB,mBAAwH,gDAC3H,kBAACrB,EAAD,UAYJiB,EAAqB,CAAEhD,OAAQ,QAASV,QAAS,OAAQC,cAAe,SAAUgE,WAAY,UAC9FN,EAAoB,CAAEjD,OAAQ,SAC9BkD,EAAmB,CAAEM,aAAc,QAASzD,SAAU,OAAQ0D,UAAW,UACzEN,EAAmB,CAAEO,WAAY,QACjCL,EAAsB,CAAEM,MAAO,OAAQrE,QAAS,OAAQC,cAAe,MAAOqE,SAAU,OAAQC,eAAgB,gBAChHP,EAAU,SAACQ,GAAD,MAAmC,CAAE9D,OAAQ,QAAS+D,KAAM,WAAYhE,SAAU,OAAQ4D,MAAO,OAAQK,OAAO,eAAD,OAAiBF,GAASjB,aAAc,MAAOD,QAAS,QCxDvLqB,IAASC,OAAO,kBAAC,EAAD,MAASC,SAASC,eAAe,W","file":"static/js/main.246107e3.chunk.js","sourcesContent":["const contextSignifier = Symbol('OrderedValues Context signifier')\n\nexport type Node<T> = T | Context<T>\n\nexport interface Context<T> {\n  readonly [contextSignifier]: undefined\n  readonly nodes: Node<T>[]\n\n  parent: Context<T> | null\n\n  registerChange: React.Dispatch<unknown>\n}\n\nexport function createContext<T>(\n  registerChange: React.Dispatch<unknown>,\n): Context<T> {\n  return {\n    [contextSignifier]: undefined,\n    nodes: [],\n    parent: null,\n    registerChange,\n  }\n}\n\nexport function isContext<T>(node: Node<T>): node is Context<T> {\n  return typeof node === 'object' && contextSignifier in node\n}\n","import { Context, isContext } from './Context'\n\nexport function firstValue<T>(\n  context: Context<T>,\n  startIndex: number,\n): T | null {\n  while (startIndex < context.nodes.length) {\n    const node = context.nodes[startIndex]\n    const result = isContext(node) ? firstValue(node, 0) : node\n    if (result !== null && result !== undefined) return result\n    ++startIndex\n  }\n  return null\n}\n\nexport function lastValue<T>(context: Context<T>, length: number): T | null {\n  while (--length >= 0) {\n    const node = context.nodes[length]\n    const result = isContext(node) ? lastValue(node, node.nodes.length) : node\n    if (result !== null && result !== undefined) return result\n  }\n  return null\n}\n\nexport function firstValueAfterReference<T>(\n  context: Context<T>,\n  reference: T,\n): T | null | undefined {\n  for (let i = 0; i < context.nodes.length; i++) {\n    const node = context.nodes[i]\n    if (isContext(node)) {\n      const result = firstValueAfterReference(node, reference)\n      if (result === undefined) continue\n      if (result !== null) return result\n    } else if (node !== reference) {\n      continue\n    }\n    return firstValue(context, i + 1)\n  }\n  return undefined\n}\n\nexport function firstValueBeforeReference<T>(\n  context: Context<T>,\n  reference: T,\n): T | null | undefined {\n  for (let i = context.nodes.length - 1; i >= 0; i--) {\n    const node = context.nodes[i]\n    if (isContext(node)) {\n      const result = firstValueBeforeReference(node, reference)\n      if (result === undefined) continue\n      if (result !== null) return result\n    } else if (node !== reference) {\n      continue\n    }\n    return lastValue(context, i)\n  }\n  return undefined\n}\n","import React, { useContext, useLayoutEffect, useMemo, useReducer } from 'react'\nimport { Context, createContext } from './Context'\nimport {\n  firstValue,\n  firstValueAfterReference,\n  firstValueBeforeReference,\n  lastValue,\n} from './operations'\n\nexport interface OrderedValues<T> {\n  Provider: React.FunctionComponent<{}>\n  useRegister: (value: T) => void\n\n  useValueAfter: (reference: T) => T | null | undefined\n  useValueBefore: (reference: T) => T | null | undefined\n  useFirst: () => T | null\n  useLast: () => T | null\n}\n\nfunction nonNull<T>(context: Context<T> | null): Context<T> {\n  if (!context)\n    throw new Error(\n      \"OrderedValues hooks can only be used within one of the OrderedValues's <Context/>s\",\n    )\n  return context\n}\n\nfunction registerChangeOnRoot(context: Context<unknown>): void {\n  context.parent\n    ? registerChangeOnRoot(context.parent)\n    : context.registerChange(undefined)\n}\n\nexport function createOrderedValues<T>(): Readonly<\n  OrderedValues<NonNullable<T>>\n> {\n  const reactContext = React.createContext<Context<NonNullable<T>> | null>(null)\n  const changeIndicatorReactContext = React.createContext<unknown>(null)\n\n  function useRoot(): Context<NonNullable<T>> {\n    let context = nonNull(useContext(reactContext))\n    while (context.parent) context = context.parent\n    return context\n  }\n\n  return {\n    Provider: function OrderedValuesProvider({ children }) {\n      const [changeIndicator, registerChange] = useReducer(\n        (counter: number) => ++counter,\n        0,\n      )\n\n      const parent = useContext(reactContext)\n      const context = useMemo<Context<NonNullable<T>>>(\n        () => createContext(registerChange),\n        [],\n      )\n\n      // Add context to parent before children are mounted\n      useMemo(() => {\n        if (!parent) return\n        context.parent = parent\n        parent.nodes.push(context)\n      }, [parent])\n\n      useLayoutEffect(() => {\n        if (!parent) return\n        registerChangeOnRoot(context)\n        return () => {\n          // Remove context from parent\n          const i = parent.nodes.indexOf(context)\n          i > -1 && parent.nodes.splice(i, 1)\n          if (context.parent === parent) context.parent = null\n        }\n      }, [parent])\n\n      return (\n        <reactContext.Provider value={context}>\n          {parent ? (\n            children\n          ) : (\n            <changeIndicatorReactContext.Provider value={changeIndicator}>\n              {children}\n            </changeIndicatorReactContext.Provider>\n          )}\n        </reactContext.Provider>\n      )\n    },\n\n    useRegister: function useRegister(t: NonNullable<T>): void {\n      const context = nonNull(useContext(reactContext))\n      useMemo(() => {\n        // Register ourself with the context\n        context.nodes.push(t)\n      }, [context, t])\n      useLayoutEffect(() => {\n        registerChangeOnRoot(context)\n        return () => {\n          // Remove ourself from the context\n          for (let i = context.nodes.length - 1; i >= 0; --i)\n            if (context.nodes[i] === t) {\n              context.nodes.splice(i, 1)\n              registerChangeOnRoot(context)\n              return\n            }\n        }\n      }, [context, t])\n    },\n\n    useValueAfter: function useValueAfter(\n      reference: NonNullable<T>,\n    ): NonNullable<T> | null | undefined {\n      useContext(changeIndicatorReactContext)\n      return firstValueAfterReference(useRoot(), reference)\n    },\n\n    useValueBefore: function useValueBefore(\n      reference: NonNullable<T>,\n    ): NonNullable<T> | null | undefined {\n      useContext(changeIndicatorReactContext)\n      return firstValueBeforeReference(useRoot(), reference)\n    },\n\n    useFirst: function useFirst(): NonNullable<T> | null {\n      useContext(changeIndicatorReactContext)\n      return firstValue(useRoot(), 0)\n    },\n\n    useLast: function useLast(): NonNullable<T> | null {\n      useContext(changeIndicatorReactContext)\n      const root = useRoot()\n      return lastValue(root, root.nodes.length)\n    },\n  }\n}\n","/**\n * Implements the example shown in the [README.md]{@link ../../README.md}.\n * \n * The imports are pulled to the top to satisfy the powers that be.\n */\n\nimport { RefObject } from 'react'\nimport { createOrderedValues } from 'react-document-order'\nimport React from 'react'\nimport { useState } from 'react'\nimport { useRef } from 'react'\nimport { SyntheticEvent } from 'react'\n\n// Start by calling `createOrderedValues()` to create a document-ordered collection.\n\nconst MyCollection = createOrderedValues<RefObject<HTMLElement>>()\n\n// The `OrderedValues` it returns provides the interface for the library.\n\nexport interface OrderedValues<T> {\n  Provider: React.FunctionComponent<{}>\n  useRegister: (value: T) => void\n\n  useValueAfter: (reference: T) => T | null | undefined\n  useValueBefore: (reference: T) => T | null | undefined\n  useFirst: () => T | null\n  useLast: () => T | null\n}\n\n// Use a `Provider` around your overall collection.\n\nexport default function ReadmeExample() {\n  return (\n    <MyCollection.Provider>\n      <MyFormContent />\n    </MyCollection.Provider>\n  )\n}\n\n// The library assumes that controls are always added at the end of their nearest `Provider` ancestor,\n// so also put a `Provider` around any section where items might get dynamically added to your collection.\n\nfunction MyFormContent() {\n  const [email, setEmail] = useState(\"\")\n  return (\n    <div style={{ display: \"flex\", flexDirection: \"column\" }}>\n      <MyInput label=\"Name\" />\n      <MyInput label=\"Email Address\" onChange={setEmail} />\n      <MyCollection.Provider>\n        {email.endsWith(\"@example.com\") && <MyInput label=\"Position at Example Corp.\" />}\n      </MyCollection.Provider>\n      <MyInput label=\"Favourite Fruit\" />\n    </div>\n  )\n}\n\n// Add elements to your collection by calling `register()`.\n\nfunction MyInput({ label, onChange }: { label: string, onChange?: (value: string) => void }) {\n  const ref = useRef<HTMLInputElement>(null)\n  MyCollection.useRegister(ref)\n  return (\n    <input\n      placeholder={label}\n      style={{maxWidth: \"20em\", margin: \"0.2em\"}}\n      onChange={onChange && (e => onChange(e.target.value))}\n      ref={ref}\n      {...useUpDownBehaviour(ref)}\n    />\n  )\n}\n\n// Then you can use the other functions on `OrderedValues` to your advantage.\n\nconst useUpDownBehaviour = (ref: RefObject<HTMLElement>) => {\n  const previous = MyCollection.useValueBefore(ref)\n  const next = MyCollection.useValueAfter(ref)\n  return {\n    onKeyDownCapture: (e: SyntheticEvent<HTMLElement, KeyboardEvent>) => {\n      if (e.nativeEvent.key === \"ArrowUp\") {\n        e.preventDefault();\n        previous?.current?.focus()\n      } else if (e.nativeEvent.key === \"ArrowDown\") {\n        e.preventDefault();\n        next?.current?.focus()\n      }\n    }\n  }\n}\n","import React, { RefObject, SyntheticEvent, useRef, useState } from 'react'\nimport { createOrderedValues } from 'react-document-order'\n\nconst ControlOrder = createOrderedValues<RefObject<HTMLElement>>()\n\nconst useUpDownBehaviour = (ref: RefObject<HTMLElement>) => {\n  const first = ControlOrder.useFirst()\n  const previous = ControlOrder.useValueBefore(ref)\n  const next = ControlOrder.useValueAfter(ref)\n  const last = ControlOrder.useLast()\n  return {\n    onKeyDownCapture: (e: SyntheticEvent<HTMLElement, KeyboardEvent>) => {\n      if (e.nativeEvent.key === \"ArrowUp\") {\n        e.preventDefault();\n        (e.nativeEvent.metaKey ? first : previous)?.current?.focus()\n      } else if (e.nativeEvent.key === \"ArrowDown\") {\n        e.preventDefault();\n        (e.nativeEvent.metaKey ? last : next)?.current?.focus()\n      }\n    }\n  }\n}\n\nconst Item = ({ onRemove }: { onRemove: () => void }) => {\n  const ref = useRef<HTMLInputElement>(null)\n  ControlOrder.useRegister(ref)\n  return <div>\n    <div style={{ flexDirection: \"row\" }}>\n      <input ref={ref} {...useUpDownBehaviour(ref)} />\n      <button onClick={onRemove}>x</button>\n    </div>\n    <div style={{ marginLeft: \"5px\", borderLeft: \"5px solid lightgray\", paddingLeft: \"5px\" }}>\n      <List addLabel=\"Add sub-item\" />\n    </div>\n  </div>\n}\n\nconst AddButton = ({ label, onClick }: { label: string, onClick: () => void }) => {\n  const ref = useRef<HTMLButtonElement>(null)\n  ControlOrder.useRegister(ref)\n  return <button ref={ref} onClick={onClick} {...useUpDownBehaviour(ref)}>{label}</button>\n}\n\nconst List = ({ addLabel }: { addLabel: string }) => {\n  const [{ ids, nextId }, setState] = useState({ ids: [] as ReadonlyArray<number>, nextId: 0 })\n  return (\n    <div style={{ flexDirection: \"column\" }}>\n      <ControlOrder.Provider>\n        {ids.map((id, i) =>\n          <div key={id} style={{ flexDirection: \"row\" }}>\n            <Item onRemove={() => setState({ ids: [...ids.slice(0, i), ...ids.slice(i + 1)], nextId })} />\n          </div>\n        )}\n      </ControlOrder.Provider>\n      <AddButton label={addLabel} onClick={() => setState({ ids: [...ids, nextId], nextId: nextId + 1 })} />\n    </div>\n  )\n}\n\nexport default function ToDoList() {\n  return (\n    <ControlOrder.Provider>\n      <p>\n        Squint hard enough, and it's a hierarchical to-do list UI.\n      </p>\n      <p>\n        Anyway, hit a few add buttons in various orders, and then see how you can use the arrow kets to\n        navigate up and down among the text inputs and add-buttons in document order.\n        Use the meta key (command key on MacOS) to move to the top or bottom of the controls in the list.\n      </p>\n      <List addLabel=\"Add top-level item\" />\n    </ControlOrder.Provider>\n  )\n}\n","import React, { useReducer } from 'react'\nimport { createOrderedValues } from 'react-document-order'\n\nconst LabelOrder = createOrderedValues<string>()\n\nconst Label = ({ name }: { name: string }) => {\n  LabelOrder.useRegister(name)\n  const next = LabelOrder.useValueAfter(name)\n  return <div style={label}>\n    Label {name} followed by {\n      next || <span role=\"img\" aria-label=\"nothing\" style={nullIndicator}>❌</span>\n    }\n  </div>\n}\n\nexport default function TrivialExample() {\n  const [middleLables, addMiddleLabel] = useReducer(([...labels], label: string) => [...labels, label], [\"baz\"])\n\n  return (\n    <LabelOrder.Provider>\n      <Label name=\"foo\" />\n      <LabelOrder.Provider>\n        {middleLables.map(l => <Label key={l} name={l} />)}\n      </LabelOrder.Provider>\n      <Label name=\"bar\" />\n      <button onClick={() => addMiddleLabel(`mid ${middleLables.length}`)}>Add</button>\n    </LabelOrder.Provider>\n  )\n}\n\nconst label = { margin: \"0.4em\", backgroundColor: \"#def\", padding: \"0.4em\", borderRadius: \"1em\" }\nconst nullIndicator = { lineHeight: 1 }\n","import React, { CSSProperties } from 'react'\nimport ReadmeExample from './ReadmeExample'\nimport ToDoList from './ToDoList'\nimport TrivialExample from './TrivialExample'\n\nconst App = () => {\n  return (\n    <div style={app}>\n\n      <h1 style={h1}><code>react-document-order</code> Demo</h1>\n\n      <p style={p}>\n        This is a small demonstration of <a\n          style={a}\n          href=\"https://github.com/barnardb/react-document-order\"\n        >react-document-order</a>.\n\n        The examples are best understood with reference to their code.\n\n        The <a\n          style={a}\n          href=\"https://github.com/barnardb/react-document-order#react-document-order\"\n        ><code>README.md</code> file</a> walks through the code implmenting the \"Readme Example\"\n      </p>\n\n      <main style={main}>\n\n        <section style={section(\"#ca8\")}>\n          <h2>Readme Example</h2>\n          <p><a style={a} href=\"https://github.com/barnardb/react-document-order/blob/main/example/src/ReadmeExample.tsx\">See the code in <code>.tsx</code></a></p>\n          <p>Use the up and down arrow keys to move between fields,\n          with and without an email address ending in \"@example.com\".</p>\n          <ReadmeExample />\n        </section>\n\n        <section style={section(\"#8ca\")}>\n          <h2>Trivial Example</h2>\n          <p><a style={a} href=\"https://github.com/barnardb/react-document-order/blob/main/example/src/TrivialExample.tsx\">See the code in <code>TrivialExample.tsx</code></a></p>\n          <p>Look at the code to see how each label refers to the next label.</p>\n          <TrivialExample />\n        </section>\n\n        <section style={section(\"#a8c\")}>\n          <h2>Hierarchical To-Do List</h2>\n          <p><a style={a} href=\"https://github.com/barnardb/react-document-order/blob/main/example/src/ToDoList.tsx\">See the code in <code>ToDoList.tsx</code></a></p>\n          <ToDoList />\n        </section>\n\n      </main>\n\n    </div>\n  )\n}\n\nexport default App\n\n// Good-enough-for-a-demo style managment ;)\nconst app: CSSProperties = { margin: \"1.5em\", display: \"flex\", flexDirection: \"column\", alignItems: \"center\" }\nconst h1: CSSProperties = { margin: \"0.5em\" }\nconst p: CSSProperties = { marginInline: \"0.5em\", maxWidth: \"40em\", textAlign: \"center\" }\nconst a: CSSProperties = { fontWeight: \"bold\" }\nconst main: CSSProperties = { width: \"100%\", display: \"flex\", flexDirection: \"row\", flexWrap: \"wrap\", justifyContent: \"space-evenly\" }\nconst section = (color: string): CSSProperties => ({ margin: \"0.5em\", flex: \"1 0 auto\", maxWidth: \"28em\", width: \"15em\", border: `0.5em solid ${color}`, borderRadius: \"1em\", padding: \"1em\" })\n","import './index.css'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}